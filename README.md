# Rasp Route Search

**Rasp Route Search** — это проект для поиска оптимальных маршрутов между городами с использованием API Яндекс.Расписания. 

---

## Функциональность

- **Запрос данных и маршрутов**  
  - Получение кода города через API Яндекс.Расписания с помощью функции `get_city_code()`.
  - Запрос маршрутов между городами на указанную дату через `get_routes()`.
  - Обработка маршрутов с разделением на этапы с использованием `extract_route_info()`.
  - Параллельное получение маршрутов между городами через `build_routes_list()` с использованием `ThreadPoolExecutor`.

- **Поиск оптимального маршрута**  
  - Функция `find_route()` реализует поиск оптимального маршрута с учетом выбранного принципа формирования приоритета (стоимость, длительность, пересадки, смешанный).
  - Возможность задать максимальное время ожидания для пересадки и количество маршрутов для вывода.
  - Расчёт приоритета маршрута осуществляется через функцию `find_priority()`, которая принимает дополнительный аргумент `priority` для определения выбранного принципа.

- **Расчёт расстояния между городами**
  - Вычисление минимального расстояния между городами по формуле Хаверсайна через функцию `distance_between_cities()`.

- **Веб-интерфейс**  
  - Пользователь может задать город отправления, город назначения, дату и время отправления, максимальное время ожидания пересадки, количество маршрутов (с помощью слайдера) и выбрать принцип формирования приоритета через горизонтальный выбор.
  - Индикатор загрузки информирует пользователя о процессе выполнения запроса.

- **Кэширование**  
  - HTTP-запросы к API кэшируются с использованием `requests_cache` (файл `rasp_cache.sqlite`, срок кэширования – 1 час).
  - Результаты функций кэшируются с помощью декоратора `@lru_cache` для повышения производительности.

---

## Требования

- **Python**: 3.7+
- **Библиотеки**:
  - Flask
  - requests
  - requests-cache

---

## Структура проекта

- **main.py**: основной модуль, содержит основную логику проекта.
- **web.py**: модуль для создания веб-интерфейса с использованием Flask.
- **index.html**: HTML-шаблон для веб-интерфейса.
- **style.css**: CSS-стили для веб-интерфейса.

---

## Установка

1. **Клонирование репозитория:**

   ```bash
   git clone https://github.com/yourusername/rasp-route-search.git
   cd rasp-route-search
   ```

2. **Создание виртуального окружения (рекомендуется):**

   ```bash
    python -m venv venv
    source venv/bin/activate      # Для Linux/Mac
    venv\Scripts\activate         # Для Windows
   ```

3. **Установка зависимостей:**

   ```bash
   pip install -r requirements.txt
   ```

---

## Использование
### Консольное использование
Запустите main.py для тестирования функциональности в консоли:

```bash
python main.py
```
Функция `routes_info()` выведет информацию о найденных маршрутах в консоль.

### Веб-интерфейс
1. **Запустите веб-сервер:**
   ```bash
   python web.py
   ```
   
2. **Откройте браузер и перейдите по адресу <http://localhost:5000/> для доступа к веб-интерфейсу.**

3. **Введите необходимые параметры:**
   - Город отправления
   - Город назначения
   - Дата и время отправления
   - Максимальное время ожидания пересадки
   - Количество маршрутов
   - Выберите принцип формирования приоритета
   - Нажмите кнопку "Найти маршрут"

4. **После отправки формы отобразится индикатор загрузки, а затем найденные маршруты в виде карточек.**

### Примечание

Данный репозиторий выложен в качестве решения кейса "Аналитика данных" в рамках чемпионата Changellenge >> Cup IT 2025.
#### Команда `чича`:
- Соседков Данил
- Зыков Григорий
- Букин Ярослав

